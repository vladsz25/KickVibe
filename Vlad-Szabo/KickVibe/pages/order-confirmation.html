<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Order Confirmed - KickVibe</title>
  <link rel="stylesheet" href="../css/main.css">
  <style>
    .confirmation-container {
      padding: var(--spacing-2xl) var(--spacing-md);
      background: linear-gradient(135deg, var(--light) 0%, var(--gray-50) 100%);
      min-height: 100vh;
    }

    .confirmation-content {
      max-width: 700px;
      margin: 0 auto;
    }

    .confirmation-success {
      background: linear-gradient(135deg, var(--success) 0%, #059669 100%);
      color: var(--white);
      padding: var(--spacing-3xl) var(--spacing-2xl);
      border-radius: var(--radius-xl);
      text-align: center;
      margin-bottom: var(--spacing-2xl);
      box-shadow: 0 10px 30px rgba(16, 185, 129, 0.3);
      animation: slideDown 500ms ease-out;
    }

    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .confirmation-icon {
      font-size: 4rem;
      margin-bottom: var(--spacing-lg);
    }

    .confirmation-success h1 {
      font-size: 2rem;
      margin-bottom: var(--spacing-md);
      color: var(--white);
    }

    .confirmation-success p {
      font-size: 1.1rem;
      opacity: 0.95;
      margin-bottom: var(--spacing-lg);
    }

    .order-number {
      font-size: 1.3rem;
      font-weight: 700;
      background: rgba(255, 255, 255, 0.2);
      padding: var(--spacing-md) var(--spacing-lg);
      border-radius: var(--radius-lg);
      display: inline-block;
      margin-bottom: var(--spacing-lg);
      font-family: monospace;
      letter-spacing: 2px;
    }

    .confirmation-card {
      background: var(--white);
      border-radius: var(--radius-xl);
      padding: var(--spacing-2xl);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      margin-bottom: var(--spacing-2xl);
    }

    .confirmation-card h2 {
      font-size: 1.3rem;
      margin-bottom: var(--spacing-lg);
      padding-bottom: var(--spacing-lg);
      border-bottom: 2px solid var(--gray-light);
    }

    .order-detail-row {
      display: flex;
      justify-content: space-between;
      padding: var(--spacing-md) 0;
      border-bottom: 1px solid var(--gray-light);
    }

    .order-detail-row:last-child {
      border-bottom: none;
    }

    .order-detail-label {
      color: var(--gray-medium);
      font-weight: 500;
    }

    .order-detail-value {
      font-weight: 700;
      color: var(--dark);
    }

    .items-list {
      max-height: 300px;
      overflow-y: auto;
      margin-bottom: var(--spacing-lg);
      padding: var(--spacing-lg) 0;
      border-bottom: 2px solid var(--gray-light);
    }

    .item-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: var(--spacing-md) 0;
      border-bottom: 1px solid var(--gray-100);
    }

    .item-info {
      flex: 1;
    }

    .item-name {
      font-weight: 600;
      margin-bottom: var(--spacing-xs);
    }

    .item-details {
      font-size: 0.85rem;
      color: var(--gray-medium);
    }

    .item-price {
      text-align: right;
      font-weight: 700;
      color: var(--primary);
      min-width: 100px;
    }

    .summary-section {
      background: var(--light);
      padding: var(--spacing-lg);
      border-radius: var(--radius-lg);
      margin-bottom: var(--spacing-lg);
    }

    .summary-row {
      display: flex;
      justify-content: space-between;
      padding: var(--spacing-sm) 0;
    }

    .summary-row.total {
      font-size: 1.2rem;
      font-weight: 700;
      color: var(--primary);
      padding: var(--spacing-md) 0;
      margin-top: var(--spacing-md);
      padding-top: var(--spacing-md);
      border-top: 2px solid rgba(0, 0, 0, 0.1);
    }

    .timeline {
      position: relative;
      padding: var(--spacing-2xl) 0;
    }

    .timeline-item {
      display: flex;
      gap: var(--spacing-lg);
      margin-bottom: var(--spacing-2xl);
      position: relative;
    }

    .timeline-item::before {
      content: '';
      position: absolute;
      left: 15px;
      top: 50px;
      width: 2px;
      height: calc(100% + 20px);
      background: var(--gray-light);
    }

    .timeline-item:last-child::before {
      display: none;
    }

    .timeline-dot {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: var(--light);
      border: 3px solid var(--primary);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
      position: relative;
      z-index: 1;
      flex-shrink: 0;
    }

    .timeline-item.completed .timeline-dot {
      background: var(--success);
      border-color: var(--success);
      color: var(--white);
    }

    .timeline-content h4 {
      margin-bottom: var(--spacing-xs);
    }

    .timeline-content p {
      color: var(--gray-medium);
      font-size: 0.9rem;
      margin: 0;
    }

    .action-buttons {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: var(--spacing-md);
      margin-top: var(--spacing-2xl);
    }

    .action-buttons .btn {
      height: 48px;
      font-size: 1rem;
      font-weight: 600;
    }

    .alert-info {
      background: rgba(59, 130, 246, 0.1);
      border: 1px solid rgba(59, 130, 246, 0.3);
      color: #3b82f6;
      padding: var(--spacing-lg);
      border-radius: var(--radius-lg);
      margin-top: var(--spacing-lg);
    }

    .alert-info strong {
      display: block;
      margin-bottom: var(--spacing-sm);
    }

    @media (max-width: 768px) {
      .action-buttons {
        grid-template-columns: 1fr;
      }

      .confirmation-success {
        padding: var(--spacing-2xl);
      }

      .confirmation-success h1 {
        font-size: 1.5rem;
      }
    }
  </style>
</head>
<body>
  <div id="notifications"></div>

  <!-- Header -->
  <header>
    <div class="container">
      <nav class="navbar">
        <a href="../index.html" class="logo">KickVibe</a>
        <div class="nav-actions">
          <a href="../index.html" class="btn btn-outline btn-small">Back to Home</a>
        </div>
      </nav>
    </div>
  </header>

  <!-- Confirmation Container -->
  <div class="confirmation-container">
    <div class="confirmation-content">

      <!-- Success Message -->
      <div class="confirmation-success">
        <div class="confirmation-icon">Order Confirmed</div>
        <h1>Order Confirmed!</h1>
        <p>Thank you for your purchase!</p>
        <div class="order-number" id="orderNumber">#000000</div>
        <p style="margin-bottom: 0;">Your sneakers are on their way! ðŸšš</p>
      </div>

      <!-- Order Details -->
      <div class="confirmation-card">
        <h2>Order Details</h2>

        <div class="order-detail-row">
          <span class="order-detail-label">Order Number</span>
          <span class="order-detail-value" id="orderID">#000000</span>
        </div>

        <div class="order-detail-row">
          <span class="order-detail-label">Date Placed</span>
          <span class="order-detail-value" id="orderDate">-</span>
        </div>

        <div class="order-detail-row">
          <span class="order-detail-label">Expected Delivery</span>
          <span class="order-detail-value">5-7 business days</span>
        </div>

        <div class="order-detail-row">
          <span class="order-detail-label">Tracking Number</span>
          <span class="order-detail-value" id="trackingNumber" style="font-family: monospace;">Coming soon</span>
        </div>

        <div class="alert-info">
          <strong>ðŸ“§ Email Confirmation</strong>
          Check your inbox for a detailed confirmation email with your tracking information.
        </div>
      </div>

      <!-- Items Ordered -->
      <div class="confirmation-card">
        <h2>Items Ordered</h2>

        <div class="items-list" id="orderItems">
          <!-- Populated by JavaScript -->
        </div>

        <div class="summary-section">
          <div class="summary-row">
            <span>Subtotal</span>
            <span id="subtotal">$0.00</span>
          </div>
          <div class="summary-row">
            <span>Shipping</span>
            <span id="shipping">$0.00</span>
          </div>
          <div class="summary-row">
            <span>Tax</span>
            <span id="tax">$0.00</span>
          </div>
          <div class="summary-row total">
            <span>Total</span>
            <span id="total">$0.00</span>
          </div>
        </div>
      </div>

      <!-- Delivery Address -->
      <div class="confirmation-card">
        <h2>Shipping Address</h2>

        <div class="order-detail-row" style="border-bottom: none;">
          <div>
            <p style="margin: 0 0 var(--spacing-sm); color: var(--gray-medium); font-size: 0.9rem;">Will be delivered to</p>
            <p style="margin: 0; font-weight: 600;" id="shippingAddress">-</p>
          </div>
        </div>
      </div>

      <!-- Timeline -->
      <div class="confirmation-card">
        <h2>What's Next?</h2>

        <div class="timeline">
          <div class="timeline-item completed">
            <div class="timeline-dot">Done</div>
            <div class="timeline-content">
              <h4>Order Confirmed</h4>
              <p>Your order has been received and is being processed</p>
            </div>
          </div>

          <div class="timeline-item">
            <div class="timeline-dot">2</div>
            <div class="timeline-content">
              <h4>Processing</h4>
              <p>We're preparing your items for shipment (24-48 hours)</p>
            </div>
          </div>

          <div class="timeline-item">
            <div class="timeline-dot">3</div>
            <div class="timeline-content">
              <h4>Shipped</h4>
              <p>Your package is on its way to you</p>
            </div>
          </div>

          <div class="timeline-item">
            <div class="timeline-dot">4</div>
            <div class="timeline-content">
              <h4>Delivered</h4>
              <p>Your sneakers have arrived!</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="action-buttons">
        <a href="./profile.html" class="btn btn-outline">View Orders</a>
        <a href="./shop.html" class="btn btn-primary">Continue Shopping</a>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer>
    <div class="container">
      <div class="footer-bottom">
        <p>&copy; 2024 KickVibe. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <script src="../js/state.js"></script>
  <script src="../js/auth.js"></script>
  <script src="../js/utils.js"></script>
  <script>
    /**
     * Get order ID from URL
     */
    function getOrderIdFromURL() {
      const params = new URLSearchParams(window.location.search);
      return params.get('id') || stateManager.getOrders()[0]?.id;
    }

    /**
     * Render order details
     */
    function renderOrderConfirmation() {
      const orderId = getOrderIdFromURL();
      const order = stateManager.getOrderById(orderId);

      if (!order) {
        // Create a sample order
        const cart = stateManager.getCart();
        if (cart.length === 0) {
          window.location.href = './shop.html';
          return;
        }

        const subtotal = stateManager.getCartTotal();
        const shipping = subtotal >= 100 ? 0 : 9.99;
        const tax = subtotal * 0.1;

        document.getElementById('orderNumber').textContent = `#${Math.random().toString().slice(2, 8).padStart(6, '0')}`;
        document.getElementById('orderID').textContent = `#${Math.random().toString().slice(2, 8).padStart(6, '0')}`;
        document.getElementById('orderDate').textContent = new Date().toLocaleDateString('en-US', { 
          year: 'numeric', 
          month: 'long', 
          day: 'numeric' 
        });

        // Items
        document.getElementById('orderItems').innerHTML = cart.map(item => `
          <div class="item-row">
            <div class="item-info">
              <div class="item-name">${item.name}</div>
              <div class="item-details">Size: ${item.size} | Quantity: ${item.quantity}</div>
            </div>
            <div class="item-price">${formatPrice(item.price * item.quantity)}</div>
          </div>
        `).join('');

        // Totals
        document.getElementById('subtotal').textContent = formatPrice(subtotal);
        document.getElementById('shipping').textContent = formatPrice(shipping);
        document.getElementById('tax').textContent = formatPrice(tax);
        document.getElementById('total').textContent = formatPrice(subtotal + shipping + tax);

        return;
      }

      // Use order from state
      document.getElementById('orderNumber').textContent = `#${order.id.toString().padStart(6, '0')}`;
      document.getElementById('orderID').textContent = `#${order.id.toString().padStart(6, '0')}`;
      document.getElementById('orderDate').textContent = new Date(order.date).toLocaleDateString('en-US', {
        year: 'numeric',
        month: 'long',
        day: 'numeric'
      });

      // Items
      document.getElementById('orderItems').innerHTML = order.items.map(item => `
        <div class="item-row">
          <div class="item-info">
            <div class="item-name">${item.name}</div>
            <div class="item-details">Size: ${item.size} | Quantity: ${item.quantity}</div>
          </div>
          <div class="item-price">${formatPrice(item.price * item.quantity)}</div>
        </div>
      `).join('');

      // Totals
      const subtotal = order.items.reduce((sum, item) => sum + (item.price * item.quantity), 0);
      const tax = subtotal * 0.1;
      const total = subtotal + order.shipping + tax;

      document.getElementById('subtotal').textContent = formatPrice(subtotal);
      document.getElementById('shipping').textContent = formatPrice(order.shipping);
      document.getElementById('tax').textContent = formatPrice(tax);
      document.getElementById('total').textContent = formatPrice(total);

      // Shipping address
      if (order.shippingInfo) {
        const addr = order.shippingInfo;
        document.getElementById('shippingAddress').textContent = 
          `${addr.firstName} ${addr.lastName}\n${addr.address}\n${addr.city}, ${addr.state} ${addr.zipCode}`;
      }
    }

    // Initialize
    window.addEventListener('load', renderOrderConfirmation);
  </script>
</body>
</html>
